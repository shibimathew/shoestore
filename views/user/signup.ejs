<%- include('../partials/user/header.ejs') %>

<section class="pt-150 pb-150">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="login_wrap widget-taber-content p-30 background-white border-radius-10">
                    <div class="padding_eight_all bg-white">
                        <div class="heading_s1 text-center">
                            <h3 class="mb-30">Create an Account</h3>
                        </div>
                        <p class="mb-30 font-sm text-muted text-center">
                            Your personal data will be used to support your experience throughout this website, to manage access to your account, and for other purposes described in our privacy policy
                        </p>
                        <form id="signform" method="post" action="/signup" class="signup-form">
                            <div class="form-group mb-3">
                                <input type="text" name="name" id="name" class="form-control" placeholder="Enter name">
                                <div id="error1" class="error-message"></div>
                            </div>
                            <div class="form-group mb-3">
                                <input type="text" name="email" id="email" class="form-control" placeholder="Enter email">
                                <div id="error2" class="error-message"></div>
                            </div>
                            <div class="form-group mb-3">
                                <input type="text" name="phone" id="phone" class="form-control" placeholder="Enter phone number">
                                <div id="error3" class="error-message"></div>
                            </div>
                            <div class="form-group mb-3">
                                <input type="password" name="password" id="password" class="form-control" placeholder="Password">
                                <div id="error4" class="error-message"></div>
                            </div>
                            <div class="form-group mb-3">
                                <input type="password" name="cPassword" id="cPassword" class="form-control" placeholder="Confirm password">
                                <div id="error5" class="error-message"></div>
                            </div>
                            <div class="login_footer form-group mb-3">
                                <div class="chek-form">
                                    <div class="custome-checkbox">
                                        <input class="form-check-input" type="checkbox" name="checkbox" id="exampleCheckbox12" value="">
                                        <label class="form-check-label" for="exampleCheckbox12"><span>I agree to terms &amp; Policy.</span></label>
                                    </div>
                                </div>
                                <a href="page-privacy-policy.html" class="text-muted"><i class="fi-rs-book-alt mr-5"></i>Learn more</a>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-fill-out btn-block hover-up" name="login">Submit &amp; Register</button>
                            </div>
                        </form>
                        <div class="divider-text-center mt-30 mb-30">
                            <span>or</span>
                        </div>
                        <ul class="btn-login list_none text-center mb-15">
                            <li><a href="/auth/google" class="btn btn-google hover-up">Login With Google</a></li>
                        </ul>
                        <div class="text-muted text-center">Already have an account? <a href="/login">Sign in now</a></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
    .error-message {
        color: #dc3545;
        font-size: 0.875rem;
        margin-top: 0.25rem;
        display: none;
    }
    .form-control {
        height: 45px;
        border-radius: 5px;
        border: 1px solid #ddd;
        padding: 0 15px;
        font-size: 14px;
    }
    .form-control:focus {
        border-color: #1e918b;
        box-shadow: 0 0 0 0.2rem rgba(30, 145, 139, 0.25);
    }
    .btn-fill-out {
        background-color: #1e918b;
        color: white;
        border: none;
        height: 45px;
        font-weight: 600;
    }
    .btn-fill-out:hover {
        background-color: #167571;
        color: white;
    }
    .divider-text-center {
        position: relative;
        text-align: center;
        margin: 20px 0;
    }
    .divider-text-center span {
        background: #fff;
        padding: 0 15px;
        color: #777;
        font-size: 14px;
    }
    .divider-text-center:before {
        content: "";
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background: #ddd;
        z-index: -1;
    }
    .btn-facebook {
        background: #3b5998;
        color: white;
    }
    .btn-google {
        background: #db4437;
        color: white;
    }
    .btn-facebook:hover, .btn-google:hover {
        opacity: 0.9;
        color: white;
    }
</style>

<script>
    const nameid = document.getElementById("name");
    const emailid = document.getElementById("email");
    const phoneid = document.getElementById("phone");
    const passid = document.getElementById("password");
    const cpassid = document.getElementById("cPassword");

    const error1 = document.getElementById("error1");
    const error2 = document.getElementById("error2");
    const error3 = document.getElementById("error3");
    const error4 = document.getElementById("error4");
    const error5 = document.getElementById("error5");
    const signform = document.getElementById("signform");

    function nameValidateChecking(e) {  // eventlistener parameter e
       const nameval = nameid.value;
       const namepattern = /^[A-Za-z\s]+$/;
       if(nameval.trim()==="") {
        error1.style.display="block";
        error1.innerHTML = "Please enter a valid name";
       } else if(!namepattern.test(nameval)) {
        error1.style.display="block";
        error1.innerHTML = "Name can only contain alphabets and spaces";
       } else {
        error1.style.display="none";
        error1.innerHTML="";
       }
    }
    
    function emailValidateChecking(e) {
        const emailval = emailid.value;
        const emailpattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;

        if (emailval.trim() === "") {
            error2.style.display = "block";
            error2.innerHTML = "Invalid Format";
        } else if (!emailpattern.test(emailval)) {
            error2.style.display = "block";
            error2.innerHTML = "Please enter a valid email format (e.g., example@mail.com)";
        } else {
            error2.style.display = "none";
            error2.innerHTML = "";
        }
    }

    function phoneValidateChecking(e) {
        const phoneval = phoneid.value;
        const phonepattern = /^[0-9]{10}$/;  // Validates 10-digit phone number

        if (phoneval.trim() === "") {
            error3.style.display = "block";
            error3.innerHTML = "Please enter a valid phone number";
        } else if (!phonepattern.test(phoneval)) {
            error3.style.display = "block";
            error3.innerHTML = "Phone number must be exactly 10 digits";
        } else {
            error3.style.display = "none";
            error3.innerHTML = "";
        }
    }

    function passValidateChecking(e) {
        const passval = passid.value;  
        const cpassval = cpassid.value;  
        const passpattern = /^(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;

        if (passval.trim() === "") {
            error4.style.display = "block";
            error4.innerHTML = "Password cannot be empty";
        } else if (!passpattern.test(passval)) {
            error4.style.display = "block";
            error4.innerHTML = "Password must be at least 8 characters, include an uppercase letter, a number, and a special character";
        } else {
            error4.style.display = "none";
            error4.innerHTML = "";
        }

        if (cpassval.trim() === "") {
            error5.style.display = "block";
            error5.innerHTML = "Confirm Password cannot be empty";
        } else if (cpassval !== passval) {
            error5.style.display = "block";
            error5.innerHTML = "Passwords do not match";
        } else {
            error5.style.display = "none";
            error5.innerHTML = "";
        }
    }

    // Attach real-time validation
    nameid.addEventListener("input", nameValidateChecking);
    emailid.addEventListener("input", emailValidateChecking);
    phoneid.addEventListener("input", phoneValidateChecking);
    passid.addEventListener("input", passValidateChecking);
    cpassid.addEventListener("input", passValidateChecking);

    // Prevent form submission if there are validation errors
    signform.addEventListener("submit", function (event) {
        nameValidateChecking();
        emailValidateChecking();
        phoneValidateChecking();
        passValidateChecking();

        if (
            error1.style.display === "block" ||
            error2.style.display === "block" ||
            error3.style.display === "block" ||
            error4.style.display === "block" ||
            error5.style.display === "block"
        ) {
            event.preventDefault();
            Swal.fire({
                icon: "error",
                text: "Please fix the errors before submitting",
                showConfirmButton: true
            });
        }
    });
</script>

<%- include('../partials/user/footer.ejs') %>